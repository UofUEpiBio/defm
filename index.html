<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimation and Simulation of Multi-Binary Response Models â€¢ defm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimation and Simulation of Multi-Binary Response Models">
<meta property="og:description" content="Multi-binary response models are a class of models that allow for the estimation of multiple binary outcomes simultaneously. This package provides functions to estimate and simulate these models using the Discrete Exponential-Family Models [DEFM] framework. In it, we implement the models described in Vega Yon, Valente, and Pugh (2023) &lt;doi:10.48550/arXiv.2211.00627&gt;. DEFMs include Exponential-Family Random Graph Models [ERGMs], which characterize graphs using sufficient statistics, which is also the core of DEFMs. Using sufficient statistics, we can describe the data through meaningful motifs, for example, transitions between different states, joint distribution of the outcomes, etc.">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">defm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/UofUEpiBio/defm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="defm-fit-and-simulate-discrete-binary-exponential-family-models">defm: Fit and simulate discrete binary exponential family models<a class="anchor" aria-label="anchor" href="#defm-fit-and-simulate-discrete-binary-exponential-family-models"></a>
</h1></div>
<!-- badges: start -->

<p>Discrete exponential family models (DEFM) have a long tradition with extensive development rooted in exponential random graph models (ERGMs.) Applicable to any form o data that can be represented as binary arrays, DEFMs provide a way to model jointly distributed binary variables.</p>
<p>This package, built on top of the C++ library <a href="https://github.com/USCbiostats/barry" class="external-link"><code>barry</code></a>, provides a computationally efficient implementation of this family of models.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>You can install <code>defm</code> using the <a href="https://cran.r-project.org/package=remotes" target="_blank" class="external-link"><code>remotes</code></a> R package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"UofUEpi/defm"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h1>
<div class="section level2">
<h2 id="example-1-four-outcomes">Example 1: Four outcomes<a class="anchor" aria-label="anchor" href="#example-1-four-outcomes"></a>
</h2>
<p>In this example, we will simulate a dataset that contains 1,000 individuals with four different outcomes. The outcomes, 0/1 vectors, will be modeled as Markov processes of order one. Future states of this 0/1 vector are a function of the previous point in time. The following lines simulate the baseline data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UofUEpiBio/defm" class="external-link">defm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: stats4</span></span>
<span></span>
<span><span class="co"># Simulation parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1231</span><span class="op">)</span></span>
<span><span class="va">n</span>   <span class="op">&lt;-</span> <span class="fl">5000L</span> <span class="co"># Count of individuals</span></span>
<span><span class="va">n_y</span> <span class="op">&lt;-</span> <span class="fl">3L</span>    <span class="co"># Number of dependent variables</span></span>
<span><span class="va">n_x</span> <span class="op">&lt;-</span> <span class="fl">2L</span>    <span class="co"># Number of independent variables</span></span>
<span></span>
<span><span class="co"># Simulating how many observations we will have per individuals</span></span>
<span><span class="va">n_reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">10</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Final number of rows in the data</span></span>
<span><span class="va">n_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n_reps</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulating the data</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_y</span> <span class="op">*</span> <span class="va">n_t</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">n_y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_y</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_x</span> <span class="op">*</span> <span class="va">n_t</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">n_x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_x</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">:</span><span class="va">n</span>, <span class="va">n_reps</span><span class="op">)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">n_reps</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span><span class="op">:</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here is a brief look at the data structure. Remember, we still have not actually simulated data <strong>WITH THE MODEL</strong>.</p>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="right">time</th>
<th align="right">y0</th>
<th align="right">y1</th>
<th align="right">y2</th>
<th align="right">x0</th>
<th align="right">x1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.51</td>
<td align="right">0.95</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.16</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1.20</td>
<td align="right">-1.72</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">-0.20</td>
<td align="right">1.55</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">-0.15</td>
<td align="right">-0.68</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1.19</td>
<td align="right">0.92</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">-0.65</td>
<td align="right">1.16</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-0.99</td>
<td align="right">0.21</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.76</td>
<td align="right">1.45</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-0.68</td>
<td align="right">-1.34</td>
</tr>
</tbody>
</table>
<p>For this example, we will simulate a model with the following features:</p>
<ul>
<li><p><strong>Ones</strong>: Baseline density (prevalence of ones), <embed src="https://latex.codecogs.com/svg.latex?%5Csum_%7Bitk%7Dy_%7Bitk%7D" title="\sum_{itk}y_{itk}"></embed></p></li>
<li><p><strong>Ones x Attr 2</strong>: Same as before, but weighted by one of the covariates. (simil to fixed effect) <embed src="https://latex.codecogs.com/svg.latex?%5Csum_%7Bitk%7Dy_%7Bitk%7Dx_%7Bit%7D" title="\sum_{itk}y_{itk}x_{it}"></embed></p></li>
<li><p><strong>Transition</strong> : And a transition structure, in particular <code>y0 -&gt; (y0, y1)</code>, <embed src="https://latex.codecogs.com/svg.latex?y_%7Bi0%7D%5E0y_%7Bi0%7D%5E%7Bt%2B1%7D%20y_%7Bi1%7D%5E%7Bt%2B1%7D" title="y_{i0}^0y_{i0}^{t+1} y_{i1}^{t+1}"></embed>.</p></li>
</ul>
<p>In <code>defm</code>, transition statistics can be represented using matrices. In this case, the transition can be written as:</p>
<p><embed src="https://latex.codecogs.com/svg.latex?%5Cbegin%7Barray%7D%7Bc%7Dt%5C%5Ct%2B1%5Cend%7Barray%7D%5Cleft%5B%5Cbegin%7Barray%7D%7Bccc%7D1%20%26%20%5Ccdot%20%26%20%5Ccdot%20%5C%5C%201%20%26%201%20%26%20%5Ccdot%5Cend%7Barray%7D%5Cright%5D" title="\begin{array}{c}t\t+1\end{array}\left[\begin{array}{ccc}1 &amp; \cdot &amp; \cdot \ 1 &amp; 1 &amp; \cdot\end{array}\right]"></embed></p>
<p>which in <code>R</code> is</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="cn">NA_integer_</span>,<span class="cn">NA_integer_</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="cn">NA_integer_</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#      [,1] [,2] [,3]</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># [1,]    1   NA   NA</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># [2,]    1    1   NA</span></span></code></pre></div>
<p>The <code>NA</code> entries in the matrix mean that those can be either zero or one. In other words, only values different from <code>NA</code> will be considered for specifying the terms. Here is the factory function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating the model and adding a couple of terms</span></span>
<span><span class="va">build_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id.</span>, <span class="va">Y.</span>, <span class="va">X.</span>, <span class="va">order.</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">par.</span> <span class="op">=</span> <span class="va">par.</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Mapping the data to the C++ wrapper</span></span>
<span>  <span class="va">d_model.</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/DEFM.html">new_defm</a></span><span class="op">(</span><span class="va">id.</span>, <span class="va">Y.</span>, <span class="va">X.</span>, order <span class="op">=</span> <span class="va">order.</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Adding the model terms</span></span>
<span>  <span class="fu"><a href="reference/defm_terms.html">td_ones</a></span><span class="op">(</span><span class="va">d_model.</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="reference/defm_terms.html">td_ones</a></span><span class="op">(</span><span class="va">d_model.</span>, covar <span class="op">=</span> <span class="st">"x1"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">transition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA_integer_</span>, nrow <span class="op">=</span> <span class="va">order.</span> <span class="op">+</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y.</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">transition</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  </span>
<span>  <span class="fu"><a href="reference/defm_terms.html">td_generic</a></span><span class="op">(</span><span class="va">d_model.</span>, <span class="va">transition</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Initializing the model</span></span>
<span>  <span class="fu"><a href="reference/DEFM.html">init_defm</a></span><span class="op">(</span><span class="va">d_model.</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Returning</span></span>
<span>  <span class="va">d_model.</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>With this factory function, we will use it to simulate some data with the same dimensions of the original dataset. In this case, the parameters used for the simulation will be:</p>
<ul>
<li>
<strong>Ones</strong>: -2, i.e., low density,</li>
<li>
<strong>Ones x Attr 2</strong>: 2, yet correlated with covariate # 2,</li>
<li>
<strong>Transition</strong> : 5, And a high chance of observing the transition <code>y0 -&gt; (y0, y1)</code>
</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">d_model</span> <span class="op">&lt;-</span> <span class="fu">build_model</span><span class="op">(</span><span class="va">id</span>, <span class="va">Y</span>, <span class="va">X</span>, order <span class="op">=</span> <span class="fl">1L</span>, par. <span class="op">=</span> <span class="va">sim_par</span><span class="op">)</span></span>
<span><span class="va">simulated_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sim_defm.html">sim_defm</a></span><span class="op">(</span><span class="va">d_model</span>, <span class="va">sim_par</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">simulated_Y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      id      </span></span>
<span><span class="co">#&gt; [1,]  1 0 0 0</span></span>
<span><span class="co">#&gt; [2,]  1 0 0 1</span></span>
<span><span class="co">#&gt; [3,]  1 0 0 0</span></span>
<span><span class="co">#&gt; [4,]  1 1 1 1</span></span>
<span><span class="co">#&gt; [5,]  2 0 1 0</span></span>
<span><span class="co">#&gt; [6,]  2 1 1 0</span></span></code></pre></div>
<p>Now, letâ€™s see if we can recover the parameters using MLE:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_model_sim</span> <span class="op">&lt;-</span> <span class="fu">build_model</span><span class="op">(</span><span class="va">id</span>, <span class="va">simulated_Y</span>, <span class="va">X</span>, order <span class="op">=</span> <span class="fl">1</span>, par. <span class="op">=</span> <span class="va">sim_par</span><span class="op">)</span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/defm_mle.html">defm_mle</a></span><span class="op">(</span><span class="va">d_model_sim</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats4::mle(minuslogl = minuslog, start = start, method = "L-BFGS-B", </span></span>
<span><span class="co">#&gt;     nobs = nrow_defm(object) + ifelse(morder_defm(object) &gt; 0, </span></span>
<span><span class="co">#&gt;         -nobs_defm(object), 0L), lower = lower, upper = upper)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                         Estimate Std. Error</span></span>
<span><span class="co">#&gt; Num. of ones           -2.009506 0.01435063</span></span>
<span><span class="co">#&gt; Num. of ones x x1       2.020209 0.01592262</span></span>
<span><span class="co">#&gt; Motif {y0+}â‡¨{y0+, y1+}  5.051076 0.04649922</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -2 log L: 54960.47</span></span></code></pre></div>
<p>Or better, we can use <code>texreg</code> to generate a pretty output:</p>
<table class="table texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Statistical models
</caption>
<thead><tr>
<th style="padding-left: 5px;padding-right: 5px;">
Â 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr></thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. of ones
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.01 (0.01)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. of ones x x1
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.02 (0.02)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Motif {y0+}â‡¨{y0+, y1+}
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.05 (0.05)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
54966.47
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
54991.16
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
N
</td>
<td style="padding-left: 5px;padding-right: 5px;">
27777
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="font-size: 0.8em;" colspan="2">
<sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05
</td>
</tr></tfoot>
</table>
<p>We can also see the counts</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">y0</th>
<th align="right">y1</th>
<th align="right">y2</th>
<th align="right">x0</th>
<th align="right">x1</th>
<th align="right">Num. of ones</th>
<th align="right">Num. of ones x x1</th>
<th align="right">Motif {y0+}â‡¨{y0+, y1+}</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.51</td>
<td align="right">0.95</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.16</td>
<td align="right">0.25</td>
<td align="right">1</td>
<td align="right">0.25</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1.20</td>
<td align="right">-1.72</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-0.20</td>
<td align="right">1.55</td>
<td align="right">3</td>
<td align="right">4.66</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">-0.15</td>
<td align="right">-0.68</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1.19</td>
<td align="right">0.92</td>
<td align="right">2</td>
<td align="right">1.84</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-0.65</td>
<td align="right">1.16</td>
<td align="right">3</td>
<td align="right">3.48</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">-0.99</td>
<td align="right">0.21</td>
<td align="right">2</td>
<td align="right">0.43</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.76</td>
<td align="right">1.45</td>
<td align="right">3</td>
<td align="right">4.35</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-0.68</td>
<td align="right">-1.34</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Finally, we can also take a look at the distribution of the log odds. We calculate this by looking at changes in a single entry of the array. For example, the log-odds of having <embed src="https://latex.codecogs.com/svg.latex?y_%7B12%7D%3A%200%5Cto%201" title="y_{12}: 0\to 1"></embed>, which are equivalent to</p>
<div class="float">
<embed src="https://latex.codecogs.com/svg.latex?%5Clog%7B%5Cfrac%7B%5Cmbox%7BPr%7D%5Cleft%28%5Cleft.y_%7B12%7D%20%3D%201%5Cvphantom%7B%5Cmathbf%7By%7D_%7B-12%7D%7D%5C%3B%5Cright%7C%5Cmathbf%7By%7D_%7B-12%7D%5Cvphantom%7By_%7B12%7D%20%3D%201%7D%5Cright%29%7D%7B%5Cmbox%7BPr%7D%5Cleft%28%5Cleft.y_%7B12%7D%20%3D%200%5Cvphantom%7B%5Cmathbf%7By%7D_%7B-12%7D%7D%5C%3B%5Cright%7C%5Cmathbf%7By%7D_%7B-12%7D%5Cvphantom%7By_%7B12%7D%20%3D%200%7D%5Cright%29%7D%7D%20%3D%20%5Cmbox%7Blogit%7D%5Cleft%28%5Cmbox%7BPr%7D%5Cleft%28%5Cleft.y_%7B12%7D%20%3D%201%5Cvphantom%7B%5Cmathbf%7By%7D_%7B-12%7D%7D%5C%3B%5Cright%7C%5Cmathbf%7By%7D_%7B-12%7D%5Cvphantom%7By_%7B12%7D%20%3D%201%7D%5Cright%29%5Cright%29" title="\log{\frac{\mbox{Pr}\left(\left.y_{12} = 1\vphantom{\mathbf{y}_{-12}};\right|\mathbf{y}_{-12}\vphantom{y_{12} = 1}\right)}{\mbox{Pr}\left(\left.y_{12} = 0\vphantom{\mathbf{y}_{-12}};\right|\mathbf{y}_{-12}\vphantom{y_{12} = 0}\right)}} = \mbox{logit}\left(\mbox{Pr}\left(\left.y_{12} = 1\vphantom{\mathbf{y}_{-12}};\right|\mathbf{y}_{-12}\vphantom{y_{12} = 1}\right)\right)"></embed><div class="figcaption"> = ((.y_{12} = 1\|_{-12}))</div>
</div>
<p>We can use the <code>logodds</code> function for this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/defm_mle.html">logodds</a></span><span class="op">(</span><span class="va">d_model_sim</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span>, <span class="fl">1</span>,  <span class="fl">2</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">lo</span>, main <span class="op">=</span> <span class="st">"Distribution of Log-odds for term Y(1,2)"</span>,</span>
<span>     col<span class="op">=</span><span class="st">"tomato"</span>, border <span class="op">=</span> <span class="st">"transparent"</span>, breaks <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-logodds-1.png" style="width:100.0%"></p>
</div>
<div class="section level2">
<h2 id="example-2-a-fun-model">Example 2: A fun model<a class="anchor" aria-label="anchor" href="#example-2-a-fun-model"></a>
</h2>
<p>For fun, imagine that we want to describe a process in which an individual moves sequentially through a set of states. In this example, there are ten different <code>y</code> variables, but the person can only have one of them as active (equal to one.) We can simulate such data using DEFM.</p>
<p>We first need to generate the baseline data for the simulation. This involves creating a matrix of size 20x10 (so we have 20 time points,) filled with zeros in all but the first entry:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span>   <span class="op">&lt;-</span> <span class="fl">20L</span></span>
<span><span class="va">n_y</span> <span class="op">&lt;-</span> <span class="fl">10L</span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0L</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">n_y</span><span class="op">)</span></span>
<span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1L</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.0</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>With the data in hand, we can now simulate the process. First, we need to build the model. The key component of the model will be the transition matrices:</p>
<div class="float">
<embed src="https://latex.codecogs.com/svg.latex?%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D%0A1%20%26%200%20%26%20NA%20%26%20%5Cdots%20%5C%5C%0A0%20%26%201%20%26%20NA%20%26%20%5Cdots%0A%5Cend%7Barray%7D%5Cright%5D%20%5Cdots%20%0A%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccccc%7D%0A%5Cdots%20%26%20NA%20%26%201%20%26%200%20%26%20NA%20%26%20%5Cdots%20%20%5C%5C%0A%5Cdots%20%26%20NA%20%26%200%20%26%201%20%26%20NA%20%26%20%5Cdots%20%20%0A%5Cend%7Barray%7D%5Cright%5D%20%5Cdots%20%0A%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D%0A%5Cdots%20%26%20NA%20%26%201%20%26%200%20%5C%5C%0A%5Cdots%20%26%20NA%20%26%200%20%26%201%20%0A%5Cend%7Barray%7D%5Cright%5D" title="\left[\begin{array}{cccc} 1 &amp; 0 &amp; NA &amp; \dots \ 0 &amp; 1 &amp; NA &amp; \dots \end{array}\right] \dots \left[\begin{array}{cccccc} \dots &amp; NA &amp; 1 &amp; 0 &amp; NA &amp; \dots \ \dots &amp; NA &amp; 0 &amp; 1 &amp; NA &amp; \dots \end{array}\right] \dots \left[\begin{array}{cccc} \dots &amp; NA &amp; 1 &amp; 0 \ \dots &amp; NA &amp; 0 &amp; 1 \end{array}\right]"></embed><div class="figcaption">[</div>
</div>
<p>Letâ€™s take a look at the process:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating a new instance of a DEFM object</span></span>
<span><span class="va">d_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/DEFM.html">new_defm</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">id</span>, Y <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span>, order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creating the transition terms, these</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n_y</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">transition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA_integer_</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="va">n_y</span><span class="op">)</span></span>
<span>  <span class="va">transition</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="reference/defm_terms.html">td_generic</a></span><span class="op">(</span><span class="va">d_model</span>, <span class="va">transition</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Here is the last transition term</span></span>
<span><span class="va">transition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA_integer_</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="va">n_y</span><span class="op">)</span></span>
<span><span class="va">transition</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n_y</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">n_y</span> <span class="op">*</span> <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/defm_terms.html">td_generic</a></span><span class="op">(</span><span class="va">d_model</span>, <span class="va">transition</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adding a term of ones</span></span>
<span><span class="fu"><a href="reference/defm_terms.html">td_ones</a></span><span class="op">(</span><span class="va">d_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initializing and simulating</span></span>
<span><span class="fu"><a href="reference/DEFM.html">init_defm</a></span><span class="op">(</span><span class="va">d_model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">Y_sim</span> <span class="op">&lt;-</span><span class="fu"><a href="reference/sim_defm.html">sim_defm</a></span><span class="op">(</span><span class="va">d_model</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">200</span>, <span class="va">n_y</span><span class="op">)</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,]    1    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [2,]    0    1    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [3,]    0    0    1    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [4,]    0    0    0    1    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [5,]    0    0    0    0    1    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [6,]    0    0    0    0    0    1    0    0    0     0</span></span>
<span><span class="co">#&gt;  [7,]    0    0    0    0    0    0    1    0    0     0</span></span>
<span><span class="co">#&gt;  [8,]    0    0    0    0    0    0    0    1    0     0</span></span>
<span><span class="co">#&gt;  [9,]    0    0    0    0    0    0    0    0    1     0</span></span>
<span><span class="co">#&gt; [10,]    0    0    0    0    0    0    0    0    0     1</span></span>
<span><span class="co">#&gt; [11,]    1    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [12,]    0    1    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [13,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [14,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [15,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [16,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [17,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [18,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [19,]    0    0    0    0    0    0    1    0    0     0</span></span>
<span><span class="co">#&gt; [20,]    0    0    0    0    0    0    0    0    0     0</span></span></code></pre></div>
<p>The simulation should produce a nice-looking figure:</p>
<p><img src="reference/figures/README-chain1fig-1.png" style="width:100.0%"></p>
</div>
<div class="section level2">
<h2 id="example-3-using-formulas-for-transitions">Example 3: Using formulas for transitions<a class="anchor" aria-label="anchor" href="#example-3-using-formulas-for-transitions"></a>
</h2>
<p>In this example, we will redo the previous model, but now use formulas for specifying the transitions:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_model_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/DEFM.html">new_defm</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">id</span>, Y <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span>, order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We can use text formulas to add transition terms</span></span>
<span><span class="va">d_model_formula</span> <span class="op">&lt;-</span> <span class="va">d_model_formula</span> <span class="op">+</span> </span>
<span>  <span class="st">"{y0, 0y1} &gt; {0y0, y1}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{y1, 0y2} &gt; {0y1, y2}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{y2, 0y3} &gt; {0y2, y3}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{y3, 0y4} &gt; {0y3, y4}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{y4, 0y5} &gt; {0y4, y5}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{y5, 0y6} &gt; {0y5, y6}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{y6, 0y7} &gt; {0y6, y7}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{y7, 0y8} &gt; {0y7, y8}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{y8, 0y9} &gt; {0y8, y9}"</span> <span class="op">+</span></span>
<span>  <span class="st">"{0y0, y9} &gt; {y0, 0y9}"</span> </span>
<span></span>
<span><span class="va">d_model_formula</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/defm_terms.html">td_ones</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/DEFM.html">init_defm</a></span><span class="op">(</span><span class="va">d_model_formula</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspecting</span></span>
<span><span class="va">d_model_formula</span></span>
<span><span class="co">#&gt; Num. of Arrays       : 19</span></span>
<span><span class="co">#&gt; Support size         : 2</span></span>
<span><span class="co">#&gt; Support size range   : [11, 20]</span></span>
<span><span class="co">#&gt; Arrays in powerset   : 2048</span></span>
<span><span class="co">#&gt; Transform. Fun.      : no</span></span>
<span><span class="co">#&gt; Model terms (11)    :</span></span>
<span><span class="co">#&gt;  - Motif {y0+, y1-}â‡¨{y0-, y1+}</span></span>
<span><span class="co">#&gt;  - Motif {y1+, y2-}â‡¨{y1-, y2+}</span></span>
<span><span class="co">#&gt;  - Motif {y2+, y3-}â‡¨{y2-, y3+}</span></span>
<span><span class="co">#&gt;  - Motif {y3+, y4-}â‡¨{y3-, y4+}</span></span>
<span><span class="co">#&gt;  - Motif {y4+, y5-}â‡¨{y4-, y5+}</span></span>
<span><span class="co">#&gt;  - Motif {y5+, y6-}â‡¨{y5-, y6+}</span></span>
<span><span class="co">#&gt;  - Motif {y6+, y7-}â‡¨{y6-, y7+}</span></span>
<span><span class="co">#&gt;  - Motif {y7+, y8-}â‡¨{y7-, y8+}</span></span>
<span><span class="co">#&gt;  - Motif {y8+, y9-}â‡¨{y8-, y9+}</span></span>
<span><span class="co">#&gt;  - Motif {y0-, y9+}â‡¨{y0+, y9-}</span></span>
<span><span class="co">#&gt;  - Num. of ones</span></span>
<span><span class="co">#&gt; Model rules (1)     :</span></span>
<span><span class="co">#&gt;  - Markov model of order 1</span></span>
<span><span class="co">#&gt; Model Y variables (10):</span></span>
<span><span class="co">#&gt;   0) y0</span></span>
<span><span class="co">#&gt;   1) y1</span></span>
<span><span class="co">#&gt;   2) y2</span></span>
<span><span class="co">#&gt;   3) y3</span></span>
<span><span class="co">#&gt;   4) y4</span></span>
<span><span class="co">#&gt;   5) y5</span></span>
<span><span class="co">#&gt;   6) y6</span></span>
<span><span class="co">#&gt;   7) y7</span></span>
<span><span class="co">#&gt;   8) y8</span></span>
<span><span class="co">#&gt;   9) y9</span></span>
<span></span>
<span><span class="co"># Simulating</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">Y_sim_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sim_defm.html">sim_defm</a></span><span class="op">(</span><span class="va">d_model_formula</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">200</span>, <span class="va">n_y</span><span class="op">)</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,]    1    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [2,]    0    1    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [3,]    0    0    1    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [4,]    0    0    0    1    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [5,]    0    0    0    0    1    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [6,]    0    0    0    0    0    1    0    0    0     0</span></span>
<span><span class="co">#&gt;  [7,]    0    0    0    0    0    0    1    0    0     0</span></span>
<span><span class="co">#&gt;  [8,]    0    0    0    0    0    0    0    1    0     0</span></span>
<span><span class="co">#&gt;  [9,]    0    0    0    0    0    0    0    0    1     0</span></span>
<span><span class="co">#&gt; [10,]    0    0    0    0    0    0    0    0    0     1</span></span>
<span><span class="co">#&gt; [11,]    1    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [12,]    0    1    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [13,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [14,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [15,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [16,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [17,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [18,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [19,]    0    0    0    0    0    0    1    0    0     0</span></span>
<span><span class="co">#&gt; [20,]    0    0    0    0    0    0    0    0    0     0</span></span></code></pre></div>
<p>The new simulationâ€¦</p>
<p><img src="reference/figures/README-chain2fig-1.png" style="width:100.0%"></p>
</div>
</div>
<div class="section level1">
<h1 id="acknowledgement">Acknowledgement<a class="anchor" aria-label="anchor" href="#acknowledgement"></a>
</h1>
<p>This work was supported by the Assistant Secretary of Defense for Health Affairs endorsed by the Department of Defense, through the Psychological Health/Traumatic Brain Injury Research Program Long-Term Impact of Military-Relevant Brain Injury Consortium (LIMBIC) Award/W81XWH-18-PH/TBIRP-LIMBIC under Award No.Â I01 RX003443. The U.S. Army Medical Research Acquisition Activity, 839 Chandler Street, Fort Detrick MD 21702-5014 is the awarding and administering acquisition office. Opinions, interpretations, conclusions and recommendations are those of the author and are not necessarily endorsed by the Department of Defense. Any opinions, findings, conclusions, or recommendations expressed in this publication are those of the author(s) and do not necessarily reflect the views of the U.S. Government, the U.S. Department of Veterans Affairs or the Department of Defense and no official endorsement should be inferred.</p>
</div>
<div class="section level1">
<h1 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h1>
<p>Please note that the <code>defm</code> project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=defm" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/UofUEpiBio/defm/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/UofUEpiBio/defm/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing defm</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>George Vega Yon <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3171-0844" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Department of Veterans Affairs - Rehabilitation, Research, and Development Service <br><small class="roles"> Funder </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=defm" class="external-link"><img src="https://www.r-pkg.org/badges/version/defm" alt="CRAN status"></a></li>
<li><a href="https://CRAN.R-project.org/package=defm" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/defm" alt="Grand total"></a></li>
<li><a href="https://github.com/UofUEpiBio/defm/actions/workflows/r.yml" class="external-link"><img src="https://github.com/UofUEpiBio/defm/actions/workflows/r.yml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by George Vega Yon, Department of Veterans Affairs - Rehabilitation, Research, and Development Service.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
